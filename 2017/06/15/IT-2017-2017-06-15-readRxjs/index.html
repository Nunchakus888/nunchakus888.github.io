<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="keywords" content="Javascript,Nunchakus,Tricking,Kufu,Roidder"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><title>RxJs初读..</title><meta name="keywords" content="JS"><body><div style="visibility: hidden; width: 0; height: 0"><img src="https://nunchakus888.github.io/images/share-logo.jpg"></div><div class="container"><div class="nav"><ul><li class="item"><a href="/">🙄️</a></li><li class="item"><a href="/archives">一篇诗</a></li><li class="item"><a href="/category">一壶酒</a></li><li class="item"><a href="/tags/">一曲长歌</a></li><li class="item"><a href="/about/">一剑天涯</a></li></ul></div><article><header><h1 class="title">RxJs初读..</h1><i class="icon-calendar"></i><span>2017.06.15 | 00:00:00</span></header><div class="content"><hr>
<h3 id="Observble"><a href="#Observble" class="headerlink" title="Observble"></a>Observble</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">export declare class Observable&lt;T&gt; implements Subscribable&lt;T&gt; &#123;</span><br><span class="line">    _isScalar: boolean;</span><br><span class="line">    protected source: Observable&lt;any&gt;;</span><br><span class="line">    protected operator: Operator&lt;any, T&gt;;</span><br><span class="line">    /**</span><br><span class="line">     * @constructor</span><br><span class="line">     * @param &#123;Function&#125; subscribe the function that is  called when the Observable is</span><br><span class="line">     * initially subscribed to. This function is given a Subscriber, to which new values</span><br><span class="line">     * can be `next`ed, or an `error` method can be called to raise an error, or</span><br><span class="line">     * `complete` can be called to notify of a successful completion.</span><br><span class="line">     */</span><br><span class="line">    constructor(subscribe?: (this: Observable&lt;T&gt;, subscriber: Subscriber&lt;T&gt;) =&gt; TeardownLogic);</span><br><span class="line">    /**</span><br><span class="line">     * Creates a new cold Observable by calling the Observable constructor</span><br><span class="line">     * @static true</span><br><span class="line">     * @owner Observable</span><br><span class="line">     * @method create</span><br><span class="line">     * @param &#123;Function&#125; subscribe? the subscriber function to be passed to the Observable constructor</span><br><span class="line">     * @return &#123;Observable&#125; a new cold observable</span><br><span class="line">     */</span><br><span class="line">    static create: Function;</span><br><span class="line">    /**</span><br><span class="line">     * Creates a new Observable, with this Observable as the source, and the passed</span><br><span class="line">     * operator defined as the new observable&apos;s operator.</span><br><span class="line">     * @method lift</span><br><span class="line">     * @param &#123;Operator&#125; operator the operator defining the operation to take on the observable</span><br><span class="line">     * @return &#123;Observable&#125; a new observable with the Operator applied</span><br><span class="line">     */</span><br><span class="line">    lift&lt;R&gt;(operator: Operator&lt;T, R&gt;): Observable&lt;R&gt;;</span><br><span class="line">    /**</span><br><span class="line">     * Registers handlers for handling emitted values, error and completions from the observable, and</span><br><span class="line">     *  executes the observable&apos;s subscriber function, which will take action to set up the underlying data stream</span><br><span class="line">     * @method subscribe</span><br><span class="line">     * @param &#123;PartialObserver|Function&#125; observerOrNext (optional) either an observer defining all functions to be called,</span><br><span class="line">     *  or the first of three possible handlers, which is the handler for each value emitted from the observable.</span><br><span class="line">     * @param &#123;Function&#125; error (optional) a handler for a terminal event resulting from an error. If no error handler is provided,</span><br><span class="line">     *  the error will be thrown as unhandled</span><br><span class="line">     * @param &#123;Function&#125; complete (optional) a handler for a terminal event resulting from successful completion.</span><br><span class="line">     * @return &#123;ISubscription&#125; a subscription reference to the registered handlers</span><br><span class="line">     */</span><br><span class="line">    subscribe(): Subscription;</span><br><span class="line">    subscribe(observer: PartialObserver&lt;T&gt;): Subscription;</span><br><span class="line">    subscribe(next?: (value: T) =&gt; void, error?: (error: any) =&gt; void, complete?: () =&gt; void): Subscription;</span><br><span class="line">    protected _trySubscribe(sink: Subscriber&lt;T&gt;): TeardownLogic;</span><br><span class="line">    /**</span><br><span class="line">     * @method forEach</span><br><span class="line">     * @param &#123;Function&#125; next a handler for each value emitted by the observable</span><br><span class="line">     * @param &#123;PromiseConstructor&#125; [PromiseCtor] a constructor function used to instantiate the Promise</span><br><span class="line">     * @return &#123;Promise&#125; a promise that either resolves on observable completion or</span><br><span class="line">     *  rejects with the handled error</span><br><span class="line">     */</span><br><span class="line">    forEach(next: (value: T) =&gt; void, PromiseCtor?: typeof Promise): Promise&lt;void&gt;;</span><br><span class="line">    protected _subscribe(subscriber: Subscriber&lt;any&gt;): TeardownLogic;</span><br><span class="line">    static if: typeof IfObservable.create;</span><br><span class="line">    static throw: typeof ErrorObservable.create;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="export-declare-class-Observable-implements-Subscribable"><a href="#export-declare-class-Observable-implements-Subscribable" class="headerlink" title="export declare class Observable implements Subscribable"></a>export declare class Observable<t> implements Subscribable<t></t></t></h5><h6 id="Let’s-go-to-the-Subscribable-difinations…"><a href="#Let’s-go-to-the-Subscribable-difinations…" class="headerlink" title="Let’s go to the Subscribable difinations…"></a>Let’s go to the Subscribable difinations…</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export interface Subscribable&lt;T&gt; &#123;</span><br><span class="line">    subscribe(observerOrNext?: PartialObserver&lt;T&gt; | ((value: T) =&gt; void), error?: (error: any) =&gt; void, complete?: () =&gt; void): AnonymousSubscription;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后发现这个Subscribable接口定义了一个subscribe方法, 看方法参数(⊙o⊙)…(⊙o⊙)…(⊙o⊙)…<br>到这里是不是直接懵圈了?(⊙o⊙)…莫方, 前方有我😋, 我们把它copy出来, 自己整理下格式, 看是个何方妖孽😋😋<br>PartialObserver, 局部观察? 继续看定义…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export declare type PartialObserver&lt;T&gt; = NextObserver&lt;T&gt; | ErrorObserver&lt;T&gt; | CompletionObserver&lt;T&gt;;</span><br></pre></td></tr></table></figure></p>
<p>好像看出来几个不同情况下的观察者, 嗯, 有点意思, 继续…<br>回车, 粗暴整理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export interface Subscribable&lt;T&gt; &#123;</span><br><span class="line">    subscribe(</span><br><span class="line">        observerOrNext?: PartialObserver&lt;T&gt; | </span><br><span class="line">            ((value: T) =&gt; void), </span><br><span class="line">            error?: (error: any) =&gt; void, </span><br><span class="line">            complete?: () =&gt; void</span><br><span class="line">    ): AnonymousSubscription;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>👉结果发现跟你读一行代码理解的一样, 这个subscribe只需要一个参数:局部<br>Observe对象或void, 最后返回AnonymousSubscription类型的对象(字面意思上好像应该理解为匿名订阅者, 其实这里我理解的是任意订阅者, 后述原委),<br>接下来我们再看看这个AnonymousSubscription<br>又是何方鬼畜😋😋😋…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export interface AnonymousSubscription &#123;</span><br><span class="line">    unsubscribe(): void;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OMG, 没看错, unsubscribe, 这里就是用来取消订阅的, 任何传给Observable构造函数的Observe对象都将在这里取消观察订阅, 那这个Observable到底做了什么呢?加subscribe添加订阅, 同时又在结尾取消订阅..</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export interface Observer&lt;T&gt; &#123;</span><br><span class="line">    closed?: boolean;</span><br><span class="line">    next: (value: T) =&gt; void;</span><br><span class="line">    error: (err: any) =&gt; void;</span><br><span class="line">    complete: () =&gt; void;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To bo continued…</p>
</div></article><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://nunchakus888.github.io/2017/06/15/IT-2017-2017-06-15-readRxjs/";
  this.page.identifier = "2017/06/15/IT-2017-2017-06-15-readRxjs/";
};

(function () {
  var d = document, s = d.createElement('script');
  s.src = 'https://Roidder.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script></div></body></head></html>