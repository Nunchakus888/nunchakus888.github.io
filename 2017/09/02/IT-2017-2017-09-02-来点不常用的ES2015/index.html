<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="keywords" content="Javascript,Nunchakus,Tricking,Kufu,Roidder"><meta property="og:image" content="logo.jpg"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><title>来点不常用的ES6.</title><meta name="keywords" content="JS,ES6"><body><div class="container"><div class="nav"><ul><li class="item"><a href="/">🙄️</a></li><li class="item"><a href="/archives">一篇诗</a></li><li class="item"><a href="/category">一壶酒</a></li><li class="item"><a href="/tags/">一曲长歌</a></li><li class="item"><a href="/about/">一剑天涯</a></li></ul></div><article><header><h1 class="title">来点不常用的ES6.</h1><i class="icon-calendar"></i><span>2017.09.02 | 01:08:08</span></header><div class="content"><hr>
<h2 id="Iterators"><a href="#Iterators" class="headerlink" title="Iterators"></a>Iterators</h2><ul>
<li>Iterators are meant to eliminate the complexity and error-prone nature of loops</li>
<li>Iterators are objects with a specific interface designed for iteration</li>
<li>next() method</li>
<li>result object {value, done}</li>
<li>keeps an internal pointer to a location within a collection of values,</li>
<li>and with each call to the next() method, it returns the next appropriate value.</li>
</ul>
<h4 id="来我们手动造一个"><a href="#来我们手动造一个" class="headerlink" title="来我们手动造一个:"></a>来我们手动造一个:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function createIterators(list) &#123;</span><br><span class="line">    let i = 0;</span><br><span class="line">    return &#123;</span><br><span class="line">        next: function() &#123;</span><br><span class="line">            const done = (i === list.length - 1);</span><br><span class="line">            const value = list[i++];</span><br><span class="line">            return &#123;</span><br><span class="line">                done: done,</span><br><span class="line">                value: value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">iterators = createIterators([1,2,3,4]);</span><br><span class="line">console.log(iterators.next()); //&#123; done: false, value: 1 &#125;</span><br><span class="line">console.log(iterators.next()); //&#123; done: false, value: 2 &#125;</span><br><span class="line">console.log(iterators.next()); //&#123; done: false, value: 3 &#125;</span><br><span class="line">console.log(iterators.next()); //&#123; done: false, value: 4 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><h3 id="基础用法："><a href="#基础用法：" class="headerlink" title="基础用法："></a>基础用法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function *createIterator() &#123;</span><br><span class="line">    yield &#123; a: 1 &#125;;</span><br><span class="line">    yield &#123; hello: &apos;world&apos;&#125;;</span><br><span class="line">    yield 3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">iterator = createIterator();</span><br><span class="line">console.log(iterator.next()); //&#123; value: &#123; a: 1 &#125;, done: false &#125;</span><br><span class="line">console.log(iterator.next()); //&#123; value: &#123; hello: &apos;world&apos; &#125;, done: false &#125;</span><br><span class="line">console.log(iterator.next()); //&#123; value: 3, done: false &#125;</span><br></pre></td></tr></table></figure>
<p>我觉得不来个while true完全不足以纵情啊😄</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function *plus() &#123;</span><br><span class="line">	let i = 0;</span><br><span class="line">	while(true) &#123;</span><br><span class="line">		yield i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">gen = plus()</span><br><span class="line">gen.next();</span><br><span class="line">gen.next();</span><br><span class="line">gen.next();</span><br></pre></td></tr></table></figure>
<h3 id="高级点的用法："><a href="#高级点的用法：" class="headerlink" title="高级点的用法："></a>高级点的用法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function *iteratorWithArgs() &#123;</span><br><span class="line">    let first = yield 10; //arg无效，10</span><br><span class="line">    let second = yield first + 2012; // arg + 2013</span><br><span class="line">    yield second + 100000000000; // arg + 100000000000</span><br><span class="line">&#125;</span><br><span class="line">iterator = iteratorWithArgs();</span><br><span class="line">console.log(iterator.next(123)); //&#123; value: 10, done: false &#125;</span><br><span class="line">console.log(iterator.next(5)); //&#123; value: 2017, done: false &#125;</span><br><span class="line">console.log(iterator.next(88888888888)); //&#123; value: 188888888888, done: false &#125;</span><br></pre></td></tr></table></figure>
<h3 id="还有带事故类型的😅："><a href="#还有带事故类型的😅：" class="headerlink" title="还有带事故类型的😅："></a>还有带事故类型的😅：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function *catchErrorIterator() &#123;</span><br><span class="line">    let first = yield 1;</span><br><span class="line">    let second;</span><br><span class="line">    try &#123;</span><br><span class="line">        second = yield first + 2; // yield 4 + 2, then throw</span><br><span class="line">    &#125; catch (ex) &#123;</span><br><span class="line">        second = 6;</span><br><span class="line">    &#125;</span><br><span class="line">    yield second + 3;</span><br><span class="line">&#125;</span><br><span class="line">iterator = catchErrorIterator();</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next(1000));</span><br><span class="line">console.log(iterator.throw(new Error(&quot;Boom&quot;))); // &quot;&#123; value: 9, done: false &#125;&quot;</span><br><span class="line">console.log(iterator.next());</span><br></pre></td></tr></table></figure>
<h3 id="还有自带制动的："><a href="#还有自带制动的：" class="headerlink" title="还有自带制动的："></a>还有自带制动的：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function *iteratorWithReturn() &#123;</span><br><span class="line">    yield 1;</span><br><span class="line">    return 10;</span><br><span class="line">    yield 2;</span><br><span class="line">    yield 3;</span><br><span class="line">&#125;</span><br><span class="line">iterator = iteratorWithReturn();</span><br><span class="line">console.log(iterator.next()); //&#123; value: 1, done: false &#125;</span><br><span class="line">console.log(iterator.next()); //&#123; value: 10, done: true &#125; </span><br><span class="line">console.log(iterator.next()); //&#123; value: undefined, done: true &#125; 前一步操作已return，so此处undefined.</span><br></pre></td></tr></table></figure>
<h3 id="再来个组合式的："><a href="#再来个组合式的：" class="headerlink" title="再来个组合式的："></a>再来个组合式的：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function *createNumberIterator() &#123;</span><br><span class="line">    yield 1;</span><br><span class="line">    yield 2;</span><br><span class="line">&#125;</span><br><span class="line">function *createColorIterator() &#123;</span><br><span class="line">    yield &quot;red&quot;;</span><br><span class="line">    yield &quot;green&quot;;</span><br><span class="line">&#125;</span><br><span class="line">function *createCombinedIterator() &#123;</span><br><span class="line">    yield *createNumberIterator();</span><br><span class="line">    yield *createColorIterator();</span><br><span class="line">    yield true;</span><br><span class="line">&#125;</span><br><span class="line">iterator = createCombinedIterator();</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next());</span><br><span class="line">console.log(iterator.next());</span><br></pre></td></tr></table></figure>
<h3 id="自动执行的"><a href="#自动执行的" class="headerlink" title="自动执行的"></a>自动执行的</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const generator = function * () &#123;</span><br><span class="line">    yield console.log();</span><br><span class="line">    yield console.log(&apos;hello&apos;);</span><br><span class="line">    yield console.log(&apos;😄&apos;);</span><br><span class="line">    while (1) &#123;</span><br><span class="line">        yield console.log(&apos;😄&apos;); //会比较欢乐，慎用啊</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">const run = myGenerator =&gt; &#123;</span><br><span class="line">    const myIterator = myGenerator();</span><br><span class="line">    let next;</span><br><span class="line">    do &#123;</span><br><span class="line">        next = myIterator.next();</span><br><span class="line">    &#125; while (!next.done)</span><br><span class="line">&#125;;</span><br><span class="line">run(generator);</span><br></pre></td></tr></table></figure>
<h3 id="异步的"><a href="#异步的" class="headerlink" title="异步的"></a>异步的</h3><p>to be continued…</p>
<h2 id="for…of…"><a href="#for…of…" class="headerlink" title="for…of…"></a>for…of…</h2><blockquote>
<p>All collection objects (arrays, sets, and maps) and strings are iterables in ECMAScript 2015</p>
</blockquote>
<p>eg: Array<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [&apos;a&apos;,&apos;b&apos;,3];</span><br><span class="line">iterator = a[Symbol.iterator]();</span><br><span class="line">console.log(iterator.next()); //&#123; value: &apos;a&apos;, done: false &#125;</span><br><span class="line">console.log(iterator.next()); //&#123; value: &apos;b&apos;, done: false &#125;</span><br><span class="line">console.log(iterator.next()); //&#123; value: 3, done: false &#125; 数组的这个迭代就有点笨了，已经是最后一个了 done还是false..会多增加一次迭代..</span><br><span class="line">console.log(iterator.next()); //&#123; value: undefined, done: true &#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>官曰：<ol>
<li>calls the Symbol.iterator method on the values array to retrieve an iterator</li>
<li>iterator.next() is called</li>
<li>the value property on the iterator’s result object is read into num</li>
<li>When done on the result object is true, the loop exits       </li>
<li>The for-of statement will throw an error when you use it on a non-iterable object, null, or undefined.</li>
</ol>
</li>
</ul>
<h3 id="iteratable？这个词感觉是强行造出来的，拼写检查报错😄"><a href="#iteratable？这个词感觉是强行造出来的，拼写检查报错😄" class="headerlink" title="iteratable？这个词感觉是强行造出来的，拼写检查报错😄"></a>iteratable？这个词感觉是强行造出来的，拼写检查报错😄</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">o = &#123;</span><br><span class="line">    1: 1,</span><br><span class="line">    2: 2,</span><br><span class="line">    3: 3,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function isIteratable(object) &#123;</span><br><span class="line">    return typeof (object[Symbol.iterator]) === &apos;function&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(isIteratable(o)); //false</span><br><span class="line">console.log(isIteratable([])); //true</span><br></pre></td></tr></table></figure>
<h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const promise = new Promise(function(resolve, reject) &#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        resolve(&apos;mdzz&apos;)</span><br><span class="line">    &#125;, 1000)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.then((data) =&gt; &#123;</span><br><span class="line">    console.error(&apos;omg--1&apos;, data); //omg--1 mdzz</span><br><span class="line">&#125;, function(err) &#123;</span><br><span class="line">    // rejection</span><br><span class="line">    console.error(err.message);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.catch(function(err) &#123;</span><br><span class="line">    // rejection</span><br><span class="line">    console.error(err.message);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><h3 id="这段是参考了人人FE大神的分享做的笔记。这样的机制在开发中还是不容易发现的。所以投个机，fork是最快的实践-amp-学习😄致敬人人FE大佬们！-人人FE"><a href="#这段是参考了人人FE大神的分享做的笔记。这样的机制在开发中还是不容易发现的。所以投个机，fork是最快的实践-amp-学习😄致敬人人FE大佬们！-人人FE" class="headerlink" title="这段是参考了人人FE大神的分享做的笔记。这样的机制在开发中还是不容易发现的。所以投个机，fork是最快的实践&amp;学习😄致敬人人FE大佬们！@人人FE"></a>这段是参考了人人FE大神的分享做的笔记。这样的机制在开发中还是不容易发现的。所以投个机，fork是最快的实践&amp;学习😄致敬人人FE大佬们！@人人FE</h3><ul>
<li>Object.seal防止新增和删除<code>属性</code>,注意只是属性哦，原对象还是可以删除的。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">来删我啊 = &#123;</span><br><span class="line">    名字: &apos;牛逼&apos;</span><br><span class="line">&#125;;</span><br><span class="line">Object.seal(来删我啊);</span><br><span class="line">来删我啊.叼不叼 = &apos;叼！&apos;;        //添加不成功</span><br><span class="line">delete 来删我啊.名字;         //false</span><br><span class="line">delete 来删我啊;            //true</span><br></pre></td></tr></table></figure>
<ul>
<li>Object.freeze冻结对象，不能改属性值。</li>
</ul>
<p>同时可以使用Object.isFrozen、Object.isSealed、Object.isExtensible判断当前对象的状态。</p>
<ul>
<li>defineProperty冻结单个属性，设置enumable/writable为false，那么<code>这个属性</code>将不可遍历和写</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a来遍历我啊 = &#123;</span><br><span class="line">    让不让遍历: &apos;坚决不让！&apos;</span><br><span class="line">&#125;;</span><br><span class="line">Object.defineProperty(a来遍历我啊, &apos;hello&apos;, &#123;</span><br><span class="line">    enumerable: false, //不可遍历</span><br><span class="line">    writable: false, //不可更改</span><br><span class="line">    value: &apos;world&apos;</span><br><span class="line">&#125;);</span><br><span class="line">for (var i in a来遍历我啊) &#123;</span><br><span class="line">    console.log(i) //输出没有hello属性.其他使用正常.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="defineProperty"><a href="#defineProperty" class="headerlink" title="defineProperty"></a>defineProperty</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function defineReactive(obj, key, val) &#123;</span><br><span class="line">    Object.defineProperty(obj, key, &#123;</span><br><span class="line">        get: function () &#123;</span><br><span class="line">            console.log(`read my attribute--&gt;$&#123;key&#125;`);</span><br><span class="line">            return val;</span><br><span class="line">        &#125;,</span><br><span class="line">        set: function (newValue) &#123;</span><br><span class="line">            console.log(`set my attribute--&gt;$&#123;key&#125;`);</span><br><span class="line">            val = newValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">function observable(o) &#123;</span><br><span class="line">    Object.keys(o).forEach(i =&gt; &#123;</span><br><span class="line">        defineReactive(o, i, o[i]);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">const o = &#123;</span><br><span class="line">    name: &apos;Jekyll&amp;Hyde&apos;,</span><br><span class="line">    age: &apos;23&apos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(o.name);</span><br><span class="line">console.log(o.name = 12332112331);</span><br></pre></td></tr></table></figure>
</div></article><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://nunchakus888.github.io/2017/09/02/IT-2017-2017-09-02-来点不常用的ES2015/";
  this.page.identifier = "2017/09/02/IT-2017-2017-09-02-来点不常用的ES2015/";
};

(function () {
  var d = document, s = d.createElement('script');
  s.src = 'https://Roidder.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script></div></body></head></html>